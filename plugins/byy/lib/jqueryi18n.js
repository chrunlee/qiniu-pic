/*
	@company 博育云
	@site : www.boyuyun.cn
	@author boyuyun
*/

function factory($){function callbackIfComplete(a){a.debug&&(console.log("callbackIfComplete()"),console.log("totalFiles: "+a.totalFiles),console.log("filesLoaded: "+a.filesLoaded)),a.async&&a.filesLoaded===a.totalFiles&&a.callback&&a.callback()}function loadAndParseFiles(a,b){null!==a&&a.length>0?loadAndParseFile(a[0],b,function(){a.shift(),loadAndParseFiles(a,b)}):callbackIfComplete(b)}function loadAndParseFile(a,b,c){b.debug&&(console.log("loadAndParseFile()"),console.log("totalFiles: "+b.totalFiles),console.log("filesLoaded: "+b.filesLoaded)),null!==a&&void 0!==a&&$.ajax({url:a,async:b.async,cache:b.cache,dataType:"text",success:function(d,e){b.debug&&console.log("Succeeded in downloading "+a+"."),parseData(d,b),c(),callbackIfComplete(b)},error:function(d,e,f){if(b.debug&&console.log("Failed to download or parse "+a+". errorThrown: "+f),"zh"!=a.substring(a.lastIndexOf("_")+1,a.lastIndexOf("."))){loadAndParseFile(a.substring(0,a.lastIndexOf("_"))+"_zh.properties",b,function(){c()})}else 404===d.status&&(b.totalFiles-=1),c()}})}function parseData(data,settings){for(var parsed="",parameters=data.split(/\n/),regPlaceHolder=/(\{\d+})/g,regRepPlaceHolder=/\{(\d+)}/g,unicodeRE=/(\\u.{4})/gi,i=0,j=parameters.length;i<j;i++){var test=parameters[i].trim();if(parameters[i]=parameters[i].trim(),parameters[i].length>0&&"#"!=parameters[i].match("^#")){var pair=parameters[i].split("=");if(pair.length>0){for(var name=decodeURI(pair[0]).trim(),value=1==pair.length?"":pair[1];"\\"==value.match(/\\$/);)value=value.substring(0,value.length-1),value+=parameters[++i].trimRight();for(var s=2;s<pair.length;s++)value+="="+pair[s];if(value=value.trim(),"map"==settings.mode||"both"==settings.mode){var unicodeMatches=value.match(unicodeRE);unicodeMatches&&unicodeMatches.forEach(function(a){value=value.replace(a,unescapeUnicode(a))}),$.i18n.map[name]=value}if("vars"==settings.mode||"both"==settings.mode)if(value=value.replace(/"/g,'\\"'),checkKeyNamespace(name),regPlaceHolder.test(value)){var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[];parts.forEach(function(a){!regPlaceHolder.test(a)||0!==usedArgs.length&&-1!=usedArgs.indexOf(a)||(first||(fnArgs+=","),fnArgs+=a.replace(regRepPlaceHolder,"v$1"),usedArgs.push(a),first=!1)}),parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";};"}else parsed+=name+'="'+value+'";'}}}eval(parsed),settings.filesLoaded+=1}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key)){var fullname="",names=key.split(/\./);names.forEach(function(name,i){i>0&&(fullname+="."),fullname+=name,eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")})}}function unescapeUnicode(a){var b=[],c=parseInt(a.substr(2),16);return c>=0&&c<Math.pow(2,16)&&b.push(c),b.reduce(function(a,b){return a+String.fromCharCode(b)},"")}$.i18n={},$.i18n.map={},$.i18n.properties=function(a){var b={name:"Messages",language:"",path:"",mode:"vars",cache:!1,debug:!1,encoding:"UTF-8",async:!1,callback:null};a=$.extend(b,a),a.language=this.normaliseLanguageCode(a.language);var c=a.name&&a.name.constructor===Array?a.name:[a.name];a.totalFiles=2*c.length+(a.language.length>=5?c.length:0),a.debug&&console.log("totalFiles: "+a.totalFiles),a.filesLoaded=0,c.forEach(function(b){var c;a.path;var d=a.language.substring(0,2);if(c=a.path+b+"_"+d+".properties",a.language.length>=5){var e=a.language.substring(0,5);a.path+b+"_"+e+".properties"}loadAndParseFiles([c],a)}),a.callback&&!a.async&&a.callback()},$.i18n.prop=function(a){var b=$.i18n.map[a];if(null===b)return"["+a+"]";var c;2==arguments.length&&$.isArray(arguments[1])&&(c=arguments[1]);var d;if("string"==typeof b){for(d=0;-1!=(d=b.indexOf("\\",d));)b="t"==b.charAt(d+1)?b.substring(0,d)+"\t"+b.substring(2+d++):"r"==b.charAt(d+1)?b.substring(0,d)+"\r"+b.substring(2+d++):"n"==b.charAt(d+1)?b.substring(0,d)+"\n"+b.substring(2+d++):"f"==b.charAt(d+1)?b.substring(0,d)+"\f"+b.substring(2+d++):"\\"==b.charAt(d+1)?b.substring(0,d)+"\\"+b.substring(2+d++):b.substring(0,d)+b.substring(d+1);var e,f,g=[];for(d=0;d<b.length;)if("'"==b.charAt(d))if(d==b.length-1)b=b.substring(0,d);else if("'"==b.charAt(d+1))b=b.substring(0,d)+b.substring(++d);else{for(e=d+2;-1!=(e=b.indexOf("'",e));){if(e==b.length-1||"'"!=b.charAt(e+1)){b=b.substring(0,d)+b.substring(d+1,e)+b.substring(e+1),d=e-1;break}b=b.substring(0,e)+b.substring(++e)}-1==e&&(b=b.substring(0,d)+b.substring(d+1))}else if("{"==b.charAt(d))if(-1==(e=b.indexOf("}",d+1)))d++;else if(f=parseInt(b.substring(d+1,e)),!isNaN(f)&&f>=0){var h=b.substring(0,d);""!==h&&g.push(h),g.push(f),d=0,b=b.substring(e+1)}else d=e+1;else d++;""!==b&&g.push(b),b=g,$.i18n.map[a]=g}if(0===b.length)return"";if(1==b.length&&"string"==typeof b[0])return b[0];var i="";for(d=0,e=b.length;d<e;d++)"string"==typeof b[d]?i+=b[d]:c&&b[d]<c.length?i+=c[b[d]]:!c&&b[d]+1<arguments.length?i+=arguments[b[d]+1]:i+="{"+b[d]+"}";return i},$.i18n.normaliseLanguageCode=function(a){return(!a||a.length<2)&&(a=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage||"en"),a=a.toLowerCase(),a=a.replace(/-/,"_"),a.length>3&&(a=a.substring(0,3)+a.substring(3).toUpperCase()),a},$.i18n.loadPro=function(a,b,c,d){$.i18n.properties({name:a,path:b,mode:"map",language:c,callback:function(){byy.renderLocal("html",d)}})},byy.define(function(a){a("i18n",$.i18n)})}window.$?factory($):(console.log("no jquery"),byy.require("jquery",function(){factory(byy.jquery)}));